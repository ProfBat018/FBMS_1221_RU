![](https://res.cloudinary.com/practicaldev/image/fetch/s--5F6dVY3f--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/568/1%2AQp_2RBl4GgCn022OZFpkfQ.jpeg)

# Как сделать `logout` в `JWT` ?

По сути для начала нужно понять что такое выход из приложения или веб сайта. Как такового понятия выхода в JWT нет. Давайте погвоорим о выходе из приложения с помощью использования 
`Cookie` аутентификации.

## Как работает `Cookie` аутентификация ?

При входе в приложение, сервер создает `Cookie` и отправляет его в браузер. Браузер сохраняет `Cookie` и при каждом запросе отправляет его на сервер. Сервер проверяет `Cookie` и если он валидный, то возвращает данные. Если `Cookie` не валидный, то сервер возвращает ошибку. При выходе из приложения, сервер удаляет `Cookie` из браузера.

По факту когда вы нажимаете на кнопку `logout` в приложении, то вы просто удаляете `Cookie` из браузера. При следующем запросе, сервер не найдет `Cookie` и вернет ошибку. Таким образом вы вышли из приложения.

## Как работает `JWT` аутентификация ?

При входе в приложение, сервер создает `JWT` и отправляет его в браузер. Браузер сохраняет `JWT` и при каждом запросе отправляет его на сервер. Сервер проверяет `JWT` и если он валидный, то возвращает данные. Если `JWT` не валидный, то сервер возвращает ошибку. 

#### Почему невозможно скопировать `JWT` из браузера и вставить в другой браузер ?

Потому что `JWT` хранится в `localStorage` и `localStorage` не доступен для чтения из другого домена. Таким образом `JWT` не может быть скопирован и вставлен в другой браузер.

Даже если вы скопируете `JWT` из `localStorage` и вставите его в другой браузер, то сервер не примет его, потому что `JWT` подписан секретным ключем. Сервер проверит подпись и если она не совпадает, то вернет ошибку.

`JWT` состоит из 3 частей: `Signature` подписывается секретным ключем и сервер проверяет подпись с помощью этого ключа.

## Почему нельзя просто взять и выйти из приложения с помощью `JWT` ?

Потому что сервер не хранит `JWT` и не может его удалить. `JWT` хранится в `localStorage` и `localStorage` не доступен для чтения из другого домена. Таким образом сервер не может удалить `JWT` из браузера.

## Как же выйти из приложения с помощью `JWT` ?

Для этого нужно использовать `Blacklist` или `Whitelist` токены. При выходе из приложения, сервер добавляет `JWT` в `Blacklist` или `Whitelist`. При следующем запросе, сервер проверяет `JWT` и если он находится в `Blacklist` или `Whitelist`, то возвращает ошибку. Таким образом вы вышли из приложения.

Есть люди, который искуственно уменьшают время жизни `JWT` и при каждом запросе обновляют `JWT`.


