# Тема урока. Эффективное обновление данных в EF Core

## Batching (пакетная обработка)

Пакетная обработка позволяет сгруппировать несколько запросов в один, что позволяет снизить количество обращений к базе данных и увеличить производительность.

```csharp

// Пакетная обработка включена по умолчанию

// Отключение пакетной обработки
optionsBuilder.UseSqlServer(connectionString, options => options.MaxBatchSize(1));

// Включение пакетной обработки
optionsBuilder.UseSqlServer(connectionString, options => options.MaxBatchSize(100));
```

### Что такое Batch ?

Batch - это набор команд, которые будут выполнены в одном запросе к базе данных.

### Как EF Core формирует Batch ?

EF Core формирует Batch на основе следующих правил:
* Каждый запрос, который будет выполнен в одном запросе к базе данных, должен быть одного типа (только Insert, только Update или только Delete)
* Каждый запрос должен быть выполнен в одной таблице
* Каждый запрос должен быть выполнен в одной схеме

# Use ExecuteUpdate and ExecuteDelete

ExecuteUpdate и ExecuteDelete позволяют выполнить запросы Update и Delete без загрузки данных в память, то есть при обычном вызове метода SaveChanges, EF Core сначала загружает данные в память, а затем выполняет запросы Update и Delete, а при использовании методов ExecuteUpdate и ExecuteDelete, EF Core сразу выполняет запросы Update и Delete без загрузки данных в память.

По умолчанию при SaveChanges ваши данные меняют данные в RAM, которые были скачаны для быстрого доступа. Если же вы хотите сразу изменить данные в базе данных, то вам нужно использовать методы ExecuteUpdate и ExecuteDelete.

### Когда использовать ExecuteUpdate и ExecuteDelete ?
Если вы не будете сразу же работать с измененными данными, то вам нужно использовать методы ExecuteUpdate и ExecuteDelete.


